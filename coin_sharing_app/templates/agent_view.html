{% extends 'Luna/base.html' %}
{% block content %}
    <!DOCTYPE html>
    <html lang="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <head>
        <meta charset="UTF-8">
        <title>Global Transaction Window</title>
        {% load staticfiles %}
        <link rel="stylesheet" href="{% static 'CSS/style.css' %}">
        <script>
            function openCoinTab(evt, name) {
                var i, tabcontent, tablinks;
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
                tablinks = document.getElementsByClassName("tablinks");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                }
                document.getElementById(name).style.display = "block";
                evt.currentTarget.className += " active";
            }
        </script>
    </head>
    <body>
    <div class="main_body">
        <h2>Personal Window</h2>
        <div class="top_pane">
            <div class="btnform_box">
                <form class="btnform" action="transaction" method="POST">
                    {% csrf_token %}
                    <button class="btn">Send coin</button>
                </form>
                <form class="btnform" action="global" method="POST">
                    {% csrf_token %}
                    <button class="btn">Global View</button>
                </form>
            </div>

            <div class="balance_box">
                <div class="total_share_coin_box">
                    Sharing Balance: {{ coin }}
                </div>
            </div>
        </div>
        <div class="main_box">
            <div class="tab">
                <button class="tablinks" onclick="openCoinTab(event, 'all_transaction')">View All</button>
                <button class="tablinks" onclick="openCoinTab(event, 'received_transaction')">View Received</button>
                <button class="tablinks" onclick="openCoinTab(event, 'sent_transaction')">View Sent</button>
                <button class="tablinks" onclick="openCoinTab(event, 'accepted')">Accept Coin?</button>
            </div>

            <div id="all_transaction" class="tabcontent">
                <table id="transaction_table">
                    <tr>
                        <th>To:</th>
                        <th>Coin Amount:</th>
                        <th>Transaction Date:</th>
                        <th>Reason:</th>
                    </tr>
                    {% for x in alltransaction %}
                        <tr>
                            <td>{{ x.to_id }}</td>
                            <td>{{ x.gave }}</td>
                            <td>{{ x.created_at }}</td>
                            <td>{{ x.note }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>

            <div id="received_transaction" class="tabcontent">
                <table id="from_transaction_table">
                    <tr>
                        <th>To:</th>
                        <th>Coin Amount:</th>
                        <th>Transaction Date:</th>
                        <th>Reason:</th>
                    </tr>
                    {% for x in senttransaction %}
                        <tr>
                            <td>{{ x.to_id }}</td>
                            <td>{{ x.gave }}</td>
                            <td>{{ x.created_at }}</td>
                            <td>{{ x.note }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>

            <div id="sent_transaction" class="tabcontent">
                <table id="to_transaction_table">
                    <tr>
                        <th>To:</th>
                        <th>Coin Amount:</th>
                        <th>Transaction Date:</th>
                        <th>Reason:</th>
                    </tr>
                    {% for x in fromtransaction %}
                        <tr>
                            <td>{{ x.to_id }}</td>
                            <td>{{ x.gave }}</td>
                            <td>{{ x.created_at }}</td>
                            <td>{{ x.note }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div id="accepted" class="tabcontent">
                {#            todo where the agent can accept the coin sent#}
                {% if to_accept >= 1 %}
                    <table>
                        <tr>
                            <th>Who:</th>
                            <th>How Much:</th>
                            <th>Note:</th>
                        </tr>
                        {% for x in to_accept %}
                            <tr>
                                <td>{{ x.from_id }}/td>
                                <td>{{ x.gave }}</td>
                                <td>{{ x.note }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}
            </div>

        </div>
    </div>
    </body>
    </html>
{% endblock %}